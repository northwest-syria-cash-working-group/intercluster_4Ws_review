by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash") %>%
ggplot(aes(area = beneficiaries, fill = beneficiaries, subgroup = admin4pcode)) +
geom_treemap() +
geom_treemap_subgroup_text(place = "centre", grow = TRUE, alpha = .5,
colour = "black", fontface = "italic") +
geom_treemap_subgroup_border(colour = "white", size = 5) +
scale_fill_viridis_c(direction = -1, labels = comma)
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries)) %>%
ggplot(aes(area = beneficiaries, fill = beneficiaries, subgroup = admin4pcode)) +
geom_treemap() +
geom_treemap_subgroup_text(place = "centre", grow = TRUE, alpha = .5,
colour = "black", fontface = "italic") +
geom_treemap_subgroup_border(colour = "white", size = 5) +
scale_fill_viridis_c(direction = -1, labels = comma)
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries) & beneficiaries > 0) %>%
ggplot(aes(area = beneficiaries, fill = beneficiaries, subgroup = admin4pcode)) +
geom_treemap() +
geom_treemap_subgroup_text(place = "centre", grow = TRUE, alpha = .5,
colour = "black", fontface = "italic") +
geom_treemap_subgroup_border(colour = "white", size = 5) +
scale_fill_viridis_c(direction = -1, labels = comma)
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries) & beneficiaries > 0) %>%
ggplot(aes(area = beneficiaries)) +
geom_treemap() +
geom_treemap_subgroup_text(place = "centre", grow = TRUE, alpha = .5,
colour = "black", fontface = "italic") +
geom_treemap_subgroup_border(colour = "white", size = 5) +
scale_fill_viridis_c(direction = -1, labels = comma)
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries) & beneficiaries > 0) %>%
ggplot(aes(area = beneficiaries)) +
geom_treemap()
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries) & beneficiaries > 0) %>%
ggplot(aes(area = beneficiaries, fill = beneficiaries, subgroup = admin3pcode)) +
geom_treemap()
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries) & beneficiaries > 0) %>%
ggplot(aes(area = beneficiaries, fill = beneficiaries)) +
geom_treemap()
com %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash") %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
mutate(pc_ben = beneficiaries / sum(beneficiaries)) %>%
arrange(desc(pc_ben)) %>%
mutate(cum_pc = cumsum(pc_ben))
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries) & beneficiaries > 0) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries)) +
ggplot(aes(area = beneficiaries, fill = beneficiaries, subgroup = admin4pcode)) +
geom_treemap() +
scale_fill_viridis_c(direction = -1, labels = comma) +
geom_treemap_subgroup_text(place = "centre", grow = TRUE, alpha = .5,
colour = "black", fontface = "italic") +
geom_treemap_subgroup_border(colour = "white", size = 5)
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries) & beneficiaries > 0) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) +
ggplot(aes(area = beneficiaries, fill = beneficiaries, subgroup = admin4pcode)) +
geom_treemap()
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries) & beneficiaries > 0) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
ggplot(aes(area = beneficiaries, fill = beneficiaries, subgroup = admin4pcode)) +
geom_treemap() +
scale_fill_viridis_c(direction = -1, labels = comma) +
geom_treemap_subgroup_text(place = "centre", grow = TRUE, alpha = .5,
colour = "black", fontface = "italic") +
geom_treemap_subgroup_border(colour = "white", size = 5)
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries) & beneficiaries > 0) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
ggplot(aes(area = beneficiaries, fill = beneficiaries)) +
geom_treemap() +
scale_fill_viridis_c(direction = -1, labels = comma)
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries) & beneficiaries > 0) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
mutate(pc_ben = round(beneficiaries / sum(beneficiaries) * 100, digits = 2)) %>%
ggplot(aes(area = beneficiaries, fill = beneficiaries)) +
geom_treemap() +
geom_treemap_text(colour = "white", place = "centre")
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries) & beneficiaries > 0) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
mutate(pc_ben = round(beneficiaries / sum(beneficiaries) * 100, digits = 2)) %>%
ggplot(aes(area = beneficiaries, fill = beneficiaries)) +
geom_treemap() +
geom_treemap_text(aes(label = pc_ben), colour = "white", place = "centre")
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries) & beneficiaries > 0) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
mutate(pc_ben = round(beneficiaries / sum(beneficiaries) * 100, digits = 2)) %>%
ggplot(aes(area = beneficiaries, fill = beneficiaries)) +
geom_treemap() +
geom_treemap_text(aes(label = pc_ben), colour = "white", place = "centre") +
scale_fill_continuous(direction = -1)
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries) & beneficiaries > 0) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
mutate(pc_ben = round(beneficiaries / sum(beneficiaries) * 100, digits = 2)) %>%
ggplot(aes(area = beneficiaries, fill = beneficiaries)) +
geom_treemap() +
geom_treemap_text(aes(label = pc_ben), colour = "white", place = "centre") +
scale_fill_viridis_c(option = "mako", direction = -1)
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries) & beneficiaries > 0) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
mutate(pc_ben = round(beneficiaries / sum(beneficiaries) * 100, digits = 2)) %>%
ggplot(aes(area = beneficiaries, fill = beneficiaries)) +
geom_treemap() +
geom_treemap_text(aes(label = pc_ben), colour = "white", place = "centre") +
scale_fill_viridis_c(option = "mako", direction = -1, end = .7) +
theme(legend.position = "none")
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries) & beneficiaries > 0) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
mutate(pc_ben = round(beneficiaries / sum(beneficiaries) * 100, digits = 2)) %>%
ggplot(aes(area = beneficiaries, fill = beneficiaries)) +
geom_treemap() +
geom_treemap_text(aes(label = pc_ben), colour = "white", place = "centre") +
scale_fill_viridis_c(option = "mako", direction = -1, end = .8) +
theme(legend.position = "none")
com %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
left_join(pop %>% select(total_pop, admin4pcode),
by = "admin4pcode") %>%
mutate(pc_ben = beneficiaries / sum(beneficiaries),
pc_pop = total_pop / sum(total_pop, na.rm = TRUE)) %>%
arrange(desc(beneficiaries)) %>%
mutate(cum_pc = pc_ben / sum(pc_ben))
com %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
left_join(pop %>% select(total_pop, admin4pcode),
by = "admin4pcode") %>%
mutate(pc_ben = beneficiaries / sum(beneficiaries),
pc_pop = total_pop / sum(total_pop, na.rm = TRUE)) %>%
arrange(desc(beneficiaries)) %>%
mutate(cum_pc = cumsum(pc_ben))
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash" & !is.na(beneficiaries) & beneficiaries > 0) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
mutate(pc_ben = round(beneficiaries / sum(beneficiaries) * 100, digits = 2)) %>%
ggplot(aes(area = beneficiaries, fill = beneficiaries)) +
geom_treemap() +
geom_treemap_text(aes(label = pc_ben), colour = "white", place = "centre") +
scale_fill_viridis_c(option = "mako", direction = -1, end = .8) +
theme(legend.position = "none") +
labs(title = "% of MPC beneficiary frequencies per community",
subtitle = "The top 10 communities form 49% of all beneficiary allocations")
pop %>% filter(admin4pcode %in% c("C1426", "C4140", "C4115")) %>%
select(admin1name_en, admin3name_en, admin4name_en)
com %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "Cash") %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
mutate(pc_ben = beneficiaries / sum(beneficiaries)) %>%
arrange(desc(pc_ben)) %>%
write_csv("./data/beneficiary_shares_admin4_cwg.csv")
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "FSL" & !is.na(beneficiaries) & beneficiaries > 0) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
mutate(pc_ben = round(beneficiaries / sum(beneficiaries) * 100, digits = 2)) %>%
ggplot(aes(area = beneficiaries, fill = beneficiaries)) +
geom_treemap() +
geom_treemap_text(aes(label = pc_ben), colour = "white", place = "centre") +
scale_fill_viridis_c(option = "mako", direction = -1, end = .8) +
theme(legend.position = "none") +
labs(title = "% of MPC beneficiary frequencies per community",
subtitle = "The top 10 communities form 49% of all beneficiary allocations")
com %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "FSL" & !is.na(beneficiaries) & beneficiaries > 0) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
mutate(pc_ben = round(beneficiaries / sum(beneficiaries) * 100, digits = 2)) %>%
ggplot(aes(area = beneficiaries, fill = beneficiaries)) +
geom_treemap() +
geom_treemap_text(aes(label = pc_ben), colour = "white", place = "centre") +
scale_fill_viridis_c(option = "cividis", direction = -1, end = .8) +
theme(legend.position = "none") +
labs(title = "% of MPC beneficiary frequencies per community",
subtitle = "The top 10 communities form 49% of all beneficiary allocations")
com %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
filter(cluster == "FSL") %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
mutate(pc_ben = beneficiaries / sum(beneficiaries)) %>%
arrange(desc(pc_ben)) %>%
# write_csv("./data/beneficiary_shares_admin4_cwg.csv")
mutate(cum_pc = cumsum(pc_ben))
pop %>% filter(admin4pcode %in% c("C4126", "C1426", "C1202", "C1564")) %>%
select(admin1name_en, admin3name_en, admin4name_en)
com %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
left_join(pop %>% select(total_pop, admin4pcode),
by = "admin4pcode") %>%
mutate(pc_ben = beneficiaries / sum(beneficiaries),
pc_pop = total_pop / sum(total_pop, na.rm = TRUE)) %>%
arrange(desc(beneficiaries)) %>%
filter(beneficiaries > 190000) %>%
left_join(locations %>%
select(admin4pcode,
district = admin2name_en,
sub_district = admin3name_en,
community = location_name_en),
by = "admin4pcode") %>%
select(district,
sub_district,
community,
ben_frequencies = beneficiaries,
total_population = total_pop) %>%
mutate(`coverage%` = round(ben_frequencies / total_population * 100, digits = 2)) %>%
flextable() %>%
theme_zebra() %>%
set_caption("Top 20 communities with the highest number of beneficiary frequencies") %>%
set_table_properties(layout = "autofit", width = .99)
summary_table <- com %>%
# Should water quality testing be included?
filter(project_status %in% c("Completed", "Ongoing") &
activity %out% c("ISIMM")) %>%
group_by(cluster) %>%
summarise(rows = n(),
ben_frequencies = sum(beneficiaries, na.rm = TRUE),
communities = n_distinct(admin4pcode)) %>%
arrange(desc(communities))
summary_table %>% unique(cluster)
summary_table
summary_table %>% distinct(cluster)
summary_table %>% nrow()
filter(summary_table, cluster == "FSL") %>% pull(communities)
com %>%
filter(activity != "ISIMM" & project_status %in% c("Completed", "Ongoing")) %>%
group_by(admin4pcode) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
left_join(pop %>% select(total_pop, admin4pcode, community = admin4name_en),
by = "admin4pcode") %>%
mutate(pc_ben = beneficiaries / sum(beneficiaries),
pc_pop = total_pop / sum(total_pop, na.rm = TRUE)) %>%
filter(beneficiaries > 0) %>%
ggplot(aes(x = pc_pop, y = pc_ben)) +
annotate(geom = "rect",
xmin = 0.00323247282, xmax = 0.08,
ymin = 0.01212922520556, ymax = 0.08,
colour = "goldenrod", alpha = 0) +
geom_point(aes(size = beneficiaries),
alpha = .7) +
scale_size_continuous(breaks = c(100, 1000, 10000, 100000, 300000, 750000),
labels = comma) +
scale_x_log10(labels = percent) +
scale_y_log10(labels = percent) +
labs(title = "The 20 communities within the yellow box have received 54% of all beneficiary allocations",
x = "Share of total population in NWS",
y = "Share of beneficiary freqiencies in NWS")
com %>%
filter(project_status %in% c("Completed", "Ongoing") & activity != "ISIMM") %>%
filter(!is.na(admin4pcode) & !is.na(activity)) %>%
pairwise_count(activity, admin4pcode, sort = TRUE, upper = FALSE) %>%
left_join(com %>%
distinct(cluster1 = cluster, activity),
by = c("item1" = "activity")) %>%
left_join(com %>%
distinct(cluster2 = cluster, activity),
by = c("item2" = "activity")) %>%
filter(cluster1 != cluster2) %>%
rename(activity1 = item1,
activity2 = item2) %>%
mutate_at(vars(activity1, activity2), ~ str_sub(., start = 0L, end = 50L)) %>%
datatable(options = list(pageLength = 10, scrollY = FALSE),
filter = list(position = "top", clear = FALSE),
caption = htmltools::tags$caption(style = 'caption-side: top;
text-align: center; font-size:120% ;',
"Cluster pairs, correlations and co-occurences"))
com %>%
filter(project_status %in% c("Completed", "Ongoing") & activity != "ISIMM") %>%
filter(!is.na(admin4pcode) & !is.na(activity)) %>%
pairwise_count(activity, admin4pcode, sort = TRUE, upper = FALSE) %>%
left_join(com %>%
distinct(cluster1 = cluster, activity),
by = c("item1" = "activity")) %>%
left_join(com %>%
distinct(cluster2 = cluster, activity),
by = c("item2" = "activity")) %>%
filter(cluster1 != cluster2) %>%
rename(activity1 = item1,
activity2 = item2) %>%
mutate_at(vars(activity1, activity2), ~ str_sub(., start = 0L, end = 50L)) %>%
select(activity1, activity2, communities = n) %>%
datatable(options = list(pageLength = 10, scrollY = FALSE),
filter = list(position = "top", clear = FALSE),
caption = htmltools::tags$caption(style = 'caption-side: top;
text-align: center; font-size:120% ;',
"Cluster pairs, correlations and co-occurences"))
com %>%
filter(project_status %in% c("Completed", "Ongoing") & activity != "ISIMM") %>%
filter(!is.na(admin4pcode) & !is.na(activity)) %>%
pairwise_count(activity, admin4pcode, sort = TRUE, upper = FALSE) %>%
left_join(com %>%
distinct(cluster1 = cluster, activity),
by = c("item1" = "activity")) %>%
left_join(com %>%
distinct(cluster2 = cluster, activity),
by = c("item2" = "activity")) %>%
filter(cluster1 != cluster2) %>%
rename(activity1 = item1,
activity2 = item2) %>%
mutate_at(vars(activity1, activity2), ~ str_sub(., start = 0L, end = 80L)) %>%
select(activity1, activity2, communities = n) %>%
datatable(options = list(pageLength = 10, scrollY = FALSE),
filter = list(position = "top", clear = FALSE),
caption = htmltools::tags$caption(style = 'caption-side: top;
text-align: center; font-size:120% ;',
"Cluster pairs, correlations and co-occurences"))
com %>%
filter(project_status %in% c("Completed", "Ongoing") & activity != "ISIMM") %>%
filter(!is.na(admin4pcode) & !is.na(activity)) %>%
pairwise_count(activity, admin4pcode, sort = TRUE, upper = FALSE) %>%
left_join(com %>%
distinct(cluster1 = cluster, activity),
by = c("item1" = "activity")) %>%
left_join(com %>%
distinct(cluster2 = cluster, activity),
by = c("item2" = "activity")) %>%
filter(cluster1 != cluster2) %>%
rename(activity1 = item1,
activity2 = item2) %>%
mutate_at(vars(activity1, activity2), ~ str_sub(., start = 0L, end = 60L)) %>%
select(activity1, activity2, communities = n) %>%
datatable(options = list(pageLength = 10, scrollY = FALSE),
filter = list(position = "top", clear = FALSE),
caption = htmltools::tags$caption(style = 'caption-side: top;
text-align: center; font-size:120% ;',
"Cluster pairs, correlations and co-occurences"))
com %>%
filter(project_status %in% c("Completed", "Ongoing") & activity != "ISIMM") %>%
filter(!is.na(admin4pcode) & !is.na(activity)) %>%
pairwise_count(activity, admin4pcode, sort = TRUE, upper = FALSE) %>%
left_join(com %>%
distinct(cluster1 = cluster, activity),
by = c("item1" = "activity")) %>%
left_join(com %>%
distinct(cluster2 = cluster, activity),
by = c("item2" = "activity")) %>%
filter(cluster1 != cluster2) %>%
rename(activity1 = item1,
activity2 = item2) %>%
mutate_at(vars(activity1, activity2), ~ str_sub(., start = 0L, end = 60L)) %>%
select(activity1, activity2, communities = n) %>%
datatable(options = list(pageLength = 10),
filter = list(position = "top", clear = FALSE),
caption = htmltools::tags$caption(style = 'caption-side: top;
text-align: center; font-size:120% ;',
"Cluster pairs, correlations and co-occurences"))
