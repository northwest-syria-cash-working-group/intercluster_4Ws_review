filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) +
filter(!is.na(damaged_houses)) %>%
ggplot(aes(x = beneficiaries, y = damaged_houses)) +
geom_point() +
scale_x_log10(labels = comma) +
scale_y_log10(labels = comma) +
geom_smooth(method = "lm")
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0) %>%
ggplot(aes(x = beneficiaries, y = damaged_houses)) +
geom_point() +
scale_x_log10(labels = comma) +
scale_y_log10(labels = comma) +
geom_smooth(method = "lm")
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
lm(beneficiaries ~ damaged_houses, data = .) %>%
tidy()
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
lm(beneficiaries ~ damaged_houses, data = .) %>%
tidy()
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
lm(beneficiaries ~ damaged_houses, data = .) %>%
tidy()
com %>%
filter(month %out% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
lm(beneficiaries ~ damaged_houses, data = .) %>%
tidy()
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
cor.test(beneficiaries, damaged_houses, method = "pearson")
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses))
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
cor.test(beneficiaries, damaged_houses, method = "pearson")
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
select(beneficiaries, damaged_houses) %>%
cor.test(method = "pearson")
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
select(beneficiaries, damaged_houses) %>%
cor(use = "pairwise.complete.obs",
method = "pearson")
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
select(beneficiaries, damaged_houses)
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
ungroup() %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
cor.test(beneficiaries, damaged_houses, method = "pearson")
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
ungroup() %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
select(beneficiaries, damaged_houses)  %>%
cor(use = "pairwise.complete.obs",
method = "pearson")
com %>%
filter(month %out% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
select(beneficiaries, damaged_houses)  %>%
cor(use = "pairwise.complete.obs",
method = "pearson")
com %>%
filter(month %out% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
ungroup() %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
select(beneficiaries, damaged_houses)  %>%
cor(use = "pairwise.complete.obs",
method = "pearson")
com %>%
eq_plot_prep() %>%
filter(damaged_houses > 0) %>%
ggplot(aes(x = beneficiaries, y = damaged_houses)) +
geom_point() +
scale_x_log10(labels = comma) +
scale_y_log10(labels = comma) +
geom_smooth(method = "lm") +
com %>%
eq_plot_prep() %>%
filter(wounded_dead > 0) %>%
ggplot(aes(x = beneficiaries, y = wounded_dead)) +
geom_point() +
scale_x_log10(labels = comma) +
scale_y_log10(labels = comma) +
geom_smooth(method = "lm") +
plot_annotation(title = "Magnitude of earthquake damage is positively correlated with the number of beneficiaries")
com %>%
eq_plot_prep() %>%
filter(damaged_houses > 0) %>%
ggplot(aes(x = beneficiaries, y = damaged_houses)) +
geom_point() +
scale_x_log10(labels = comma) +
scale_y_log10(labels = comma) +
geom_smooth(method = "lm") +
com %>%
eq_plot_prep() %>%
filter(wounded_dead > 0) %>%
ggplot(aes(x = beneficiaries, y = wounded_dead)) +
geom_point() +
scale_x_log10(labels = comma) +
scale_y_log10(labels = comma) +
geom_smooth(method = "lm") +
plot_annotation(title = "Magnitude of earthquake damage positively correlated with beneficiaries")
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0) %>%
ggplot(aes(x = beneficiaries, y = damaged_houses)) +
geom_point() +
scale_x_log10(labels = comma) +
scale_y_log10(labels = comma) +
geom_smooth(method = "lm") +
com %>%
eq_prep_score() %>%
filter(damaged_houses > 0) %>%
ggplot(aes(x = beneficiaries, y = total_pop)) +
geom_point() +
scale_x_log10(labels = comma) +
scale_y_log10(labels = comma) +
geom_smooth(method = "lm")
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0) %>%
ggplot(aes(x = beneficiaries, y = damaged_houses)) +
geom_point() +
scale_x_log10(labels = comma) +
scale_y_log10(labels = comma) +
geom_smooth(method = "lm") +
com %>%
eq_plot_prep() %>%
filter(damaged_houses > 0) %>%
ggplot(aes(x = beneficiaries, y = total_pop)) +
geom_point() +
scale_x_log10(labels = comma) +
scale_y_log10(labels = comma) +
geom_smooth(method = "lm")
com %>%
eq_plot_prep() %>%
ungroup() %>%
select(beneficiaries, damaged_houses)  %>%
cor(use = "pairwise.complete.obs",
method = "pearson")
com %>%
eq_plot_prep() %>%
ungroup() %>%
lm(beneficiaries ~ damaged_houses, data = .) %>%
tidy()
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
ungroup() %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
select(beneficiaries, damaged_houses)  %>%
lm(beneficiaries ~ damaged_houses, data = .) %>%
tidy()
com %>%
eq_plot_prep() %>%
ungroup() %>%
lm(beneficiaries ~ damaged_houses, data = .) %>%
tidy()
rbind(
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
ungroup() %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
select(beneficiaries, damaged_houses)  %>%
lm(beneficiaries ~ damaged_houses, data = .) %>%
tidy() %>%
mutate(term = ifelse(term == "damaged_houses", "damaged_houses_jan_ben")),
com %>%
eq_plot_prep() %>%
ungroup() %>%
lm(beneficiaries ~ damaged_houses, data = .) %>%
tidy() %>%
mutate(term = ifelse(term == "damaged_houses", "damaged_houses_jan_ben"))
) %>%
filter(term != "(Intercept)")
rbind(
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
ungroup() %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
select(beneficiaries, damaged_houses)  %>%
lm(beneficiaries ~ damaged_houses, data = .) %>%
tidy() %>%
mutate(term = ifelse(term == "damaged_houses", "damaged_houses_jan_ben", term)),
com %>%
eq_plot_prep() %>%
ungroup() %>%
lm(beneficiaries ~ damaged_houses, data = .) %>%
tidy() %>%
mutate(term = ifelse(term == "damaged_houses", "damaged_houses_jan_ben", term))
) %>%
filter(term != "(Intercept)")
rbind(
com %>%
filter(month %in% c("jan")) %>%
group_by(admin4pcode) %>%
slice(which.max(beneficiaries)) %>%
ungroup() %>%
left_join(pop %>%
select(total_pop, admin4pcode),
by = "admin4pcode") %>%
left_join(eq %>%
select(admin4pcode,
wounded_dead_100k,
damaged_houses_100k,
wounded_dead,
damaged_houses),
by = "admin4pcode") %>%
mutate(pc_reached = beneficiaries / total_pop) %>%
filter(damaged_houses > 0 & !is.na(damaged_houses)) %>%
select(beneficiaries, damaged_houses)  %>%
lm(beneficiaries ~ damaged_houses, data = .) %>%
tidy() %>%
mutate(term = ifelse(term == "damaged_houses", "damaged_houses_jan_ben", term)),
com %>%
eq_plot_prep() %>%
ungroup() %>%
lm(beneficiaries ~ damaged_houses, data = .) %>%
tidy() %>%
mutate(term = ifelse(term == "damaged_houses", "damaged_houses_after_jan_ben", term))
) %>%
filter(term != "(Intercept)")
